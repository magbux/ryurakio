local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local Lighting = game:GetService("Lighting")
local Workspace = game:GetService("Workspace")
local VirtualUser = game:GetService("VirtualUser")
local TextChatService = game:GetService("TextChatService")
local LocalPlayer = Players.LocalPlayer

local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local SaveManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/SaveManager.lua"))()
local InterfaceManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/InterfaceManager.lua"))()

local Window = Fluent:CreateWindow({
    Title = "Ryusai-HubðŸš¬",
    SubTitle = "ryusai hubðŸƒ",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.RightShift
})

local Tabs = {
    Main = Window:AddTab({ Title = "Main", Icon = "rbxassetid://6031097225" }),
    Player = Window:AddTab({ Title = "Player", Icon = "rbxassetid://6031075938" }),
    Misc = Window:AddTab({ Title = "Misc", Icon = "rbxassetid://6031097226" }),
    Settings = Window:AddTab({ Title = "Settings", Icon = "rbxassetid://6031280882" }),
    Extras = Window:AddTab({ Title = "Extras", Icon = "rbxassetid://6031094670" })
}

local function safeNotify(title, content, dur)
    Fluent:Notify({ Title = title, Content = content or "", Duration = dur or 4 })
end

local function safeRunAsync(fn)
    spawn(function()
        pcall(fn)
    end)
end

local MainSection = Tabs.Main:AddSection("Features")

MainSection:AddButton({
    Title = "Load Reviz",
    Description = "Loads Reviz admin script",
    Callback = function()
        safeRunAsync(function()
            loadstring(game:HttpGet("https://gist.githubusercontent.com/princemiguel1234/af2a4841416e2aa41cce2017a14f2fff/raw/471718ec692954af5028cb8f922f00c66afd954d/Reviz%20Admin%20V2"))()
        end)
    end
})

MainSection:AddButton({
    Title = "Load Infinite Yield",
    Description = "Loads Infinite Yield admin script",
    Callback = function()
        safeRunAsync(function()
            loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()
        end)
    end
})

MainSection:AddButton({
    Title = "Load fling script",
    Description = "Loads fling script",
    Callback = function()
        safeRunAsync(function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/LiarRise/FLN-X/refs/heads/main/README.md"))()
        end)
    end
})

MainSection:AddButton({
    Title = "Load invisible script",
    Description = "Loads invis script",
    Callback = function()
        safeRunAsync(function()
            loadstring(game:HttpGet('https://pastebin.com/raw/3Rnd9rHf'))()
        end)
    end
})

local ESPEnabled = false
local espCoroutine = nil

MainSection:AddToggle("ESP", {
    Title = "ESP",
    Description = "Toggle ESP for players",
    Default = false,
    Callback = function(state)
        ESPEnabled = state
        if ESPEnabled then
            if espCoroutine and coroutine.status(espCoroutine) ~= "dead" then return end
            espCoroutine = coroutine.create(function()
                while ESPEnabled do
                    for _, player in pairs(Players:GetPlayers()) do
                        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                            local highlight = player.Character:FindFirstChildOfClass("Highlight")
                            if not highlight then
                                highlight = Instance.new("Highlight")
                                highlight.Parent = player.Character
                                highlight.FillTransparency = 0.6
                                highlight.OutlineTransparency = 0.9
                            end
                        end
                    end
                    task.wait()
                end
                -- cleanup highlights when disabled
                for _, player in pairs(Players:GetPlayers()) do
                    if player.Character then
                        local hl = player.Character:FindFirstChildOfClass("Highlight")
                        if hl then pcall(function() hl:Destroy() end) end
                    end
                end
            end)
            coroutine.resume(espCoroutine)
        else
            -- if toggle turned off while coroutine still running the coroutine will handle cleanup,
            -- but ensure existing highlights are removed immediately as well
            for _, player in pairs(Players:GetPlayers()) do
                if player.Character then
                    local hl = player.Character:FindFirstChildOfClass("Highlight")
                    if hl then pcall(function() hl:Destroy() end) end
                end
            end
        end
    end
})

local FlyEnabled = false
local flyBodyVelocity = nil
local flyBodyGyro = nil
local flySpeed = 100
local flyConnection = nil

local function startFlying()
    local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local humanoid = character:WaitForChild("Humanoid")
    local rootPart = character:WaitForChild("HumanoidRootPart")

    if flyBodyVelocity and flyBodyVelocity.Parent then
        flyBodyVelocity:Destroy()
    end
    if flyBodyGyro and flyBodyGyro.Parent then
        flyBodyGyro:Destroy()
    end
    if flyConnection and flyConnection.Connected then
        flyConnection:Disconnect()
    end

    flyBodyVelocity = Instance.new("BodyVelocity")
    flyBodyVelocity.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    flyBodyVelocity.Velocity = Vector3.new(0,0,0)
    flyBodyVelocity.Parent = rootPart

    flyBodyGyro = Instance.new("BodyGyro")
    flyBodyGyro.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
    flyBodyGyro.P = 9e4
    flyBodyGyro.CFrame = rootPart.CFrame
    flyBodyGyro.Parent = rootPart

    flyConnection = RunService.Heartbeat:Connect(function()
        if not FlyEnabled or not rootPart or not rootPart.Parent then return end
        humanoid.PlatformStand = true

        local cam = workspace.CurrentCamera
        local moveDir = Vector3.new(0,0,0)

        if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveDir = moveDir + cam.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveDir = moveDir - cam.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveDir = moveDir - cam.CFrame.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveDir = moveDir + cam.CFrame.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.Space) then moveDir = moveDir + Vector3.new(0,1,0) end
        if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then moveDir = moveDir - Vector3.new(0,1,0) end

        if moveDir.Magnitude > 0 then moveDir = moveDir.Unit end
        flyBodyVelocity.Velocity = moveDir * flySpeed
        flyBodyGyro.CFrame = cam.CFrame
    end)
end

local function stopFlying()
    FlyEnabled = false
    if flyBodyVelocity and flyBodyVelocity.Parent then
        flyBodyVelocity:Destroy()
        flyBodyVelocity = nil
    end
    if flyBodyGyro and flyBodyGyro.Parent then
        flyBodyGyro:Destroy()
        flyBodyGyro = nil
    end
    if flyConnection and flyConnection.Connected then
        flyConnection:Disconnect()
        flyConnection = nil
    end
    local hum = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
    if hum then
        hum.PlatformStand = false
    end
end

MainSection:AddToggle("Fly", {
    Title = "Fly",
    Description = "Toggle flying",
    Default = false,
    Callback = function(state)
        FlyEnabled = state
        if FlyEnabled then
            startFlying()
        else
            stopFlying()
        end
    end
})

LocalPlayer.CharacterAdded:Connect(function()
    if FlyEnabled then
        task.wait(0.5)
        startFlying()
    end
end)

if LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid") then
    LocalPlayer.Character:FindFirstChildOfClass("Humanoid").Died:Connect(function()
        if FlyEnabled then stopFlying() end
    end)
end

local godmode = false
local godConnection = nil

MainSection:AddToggle("GodMode", {
    Title = "God Mode",
    Description = "the name explains it",
    Default = false,
    Callback = function(state)
        godmode = state

        if godmode then
            if godConnection then godConnection:Disconnect() end

            godConnection = game:GetService("RunService").Heartbeat:Connect(function()
                local char = LocalPlayer.Character
                if char then
                    local hum = char:FindFirstChildOfClass("Humanoid")
                    if hum then
                        hum.Health = hum.MaxHealth
                        hum.BreakJointsOnDeath = false
                        pcall(function() hum:SetStateEnabled(Enum.HumanoidStateType.Dead, false) end)
                        if hum.Health <= 0 then
                            hum.Health = hum.MaxHealth
                        end
                    end
                end
            end)

            safeNotify("God Mode", "God mode enabled", 4)
        else
            if godConnection then
                godConnection:Disconnect()
                godConnection = nil
            end
            safeNotify("God Mode", "God mode disabled", 4)
        end
    end
})

local NoclipEnabled = false
local noclipConnection = nil

MainSection:AddToggle("Noclip", {
    Title = "Noclip",
    Description = "Toggle noclip",
    Default = false,
    Callback = function(state)
        NoclipEnabled = state
        if NoclipEnabled then
            if noclipConnection and noclipConnection.Connected then return end
            noclipConnection = RunService.Stepped:Connect(function()
                local char = LocalPlayer.Character
                if char then
                    for _, part in pairs(char:GetDescendants()) do
                        if part:IsA("BasePart") and part.CanCollide then
                            part.CanCollide = false
                        end
                    end
                end
            end)
        else
            if noclipConnection then
                noclipConnection:Disconnect()
                noclipConnection = nil
            end
        end
    end
})

MainSection:AddButton({
    Title = "abominator",
    Description = "Make your character abominate downward",
    Callback = function()
        local char = LocalPlayer.Character
        if not char then return end
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end

        local humanoid = char:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.PlatformStand = true
        end

        local slipVelocity = Instance.new("BodyVelocity")
        slipVelocity.MaxForce = Vector3.new(0, math.huge, 0)
        slipVelocity.Velocity = Vector3.new(0, -50, 0)
        slipVelocity.Parent = hrp

        task.delay(1, function()
            if slipVelocity and slipVelocity.Parent then
                slipVelocity:Destroy()
            end
            if humanoid then
                humanoid.PlatformStand = false
            end
        end)
    end
})

local InvisibleEnabled = false
local originalTransparency = {}
local originalCanCollide = {}

local function applyInvisibility()
    local char = LocalPlayer.Character
    if not char then return end
    for _, part in pairs(char:GetDescendants()) do
        if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
            originalTransparency[part] = part.Transparency
            originalCanCollide[part] = part.CanCollide
            part.Transparency = 1
            part.CanCollide = false
        elseif part:IsA("Decal") or part:IsA("Texture") then
            originalTransparency[part] = part.Transparency
            part.Transparency = 1
        end
    end
    for _, acc in pairs(char:GetChildren()) do
        if acc:IsA("Accessory") then
            local handle = acc:FindFirstChild("Handle")
            if handle then
                originalTransparency[handle] = handle.Transparency
                handle.Transparency = 1
            end
        end
    end
end

local function removeInvisibility()
    for part, trans in pairs(originalTransparency) do
        if part and part.Parent then
            pcall(function()
                part.Transparency = trans
                if originalCanCollide[part] ~= nil then
                    part.CanCollide = originalCanCollide[part]
                end
            end)
        end
    end
    originalTransparency = {}
    originalCanCollide = {}
end

MainSection:AddToggle("True Invisible", {
    Title = "Invisible",
    Description = "invisible and + no collide",
    Default = false,
    Callback = function(state)
        InvisibleEnabled = state
        if InvisibleEnabled then
            applyInvisibility()
        else
            removeInvisibility()
        end
    end
})

MainSection:AddButton({
    Title = "Reset",
    Description = "Reset",
    Callback = function()
        if LocalPlayer.Character then pcall(function() LocalPlayer.Character:BreakJoints() end) end
    end
})

LocalPlayer.CharacterAdded:Connect(function()
    if InvisibleEnabled then
        task.wait(0.5)
        applyInvisibility()
    end
end)

MainSection:AddSlider("WalkSpeed", {
    Title = "Walk Speed",
    Description = "Adjust walk speed",
    Default = 16,
    Min = 16,
    Max = 500,
    Rounding = 1,
    Callback = function(value)
        local hum = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass('Humanoid')
        if hum then hum.WalkSpeed = value end
    end
})

MainSection:AddSlider("JumpPower", {
    Title = "Jump Power",
    Description = "Adjust jump power",
    Default = 50,
    Min = 50,
    Max = 500,
    Rounding = 1,
    Callback = function(value)
        local hum = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass('Humanoid')
        if hum then hum.JumpPower = value end
    end
})

MainSection:AddButton({
    Title = "Teleport to Spawn",
    Description = "TP to spawn location",
    Callback = function()
        if LocalPlayer.Character and workspace:FindFirstChild("SpawnLocation") then
            local root = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if root then root.CFrame = workspace.SpawnLocation.CFrame end
        end
    end
})

MainSection:AddButton({
    Title = "Auto Farm",
    Description = "Placeholder for auto farming",
    Callback = function()
        safeNotify("Auto Farm", "Auto farm placeholder - implement your logic here", 5)
    end
})

MainSection:AddButton({
    Title = "Anti AFK",
    Description = "Prevent AFK kick",
    Callback = function()
        local vu = game:GetService("VirtualUser")
        LocalPlayer.Idled:Connect(function()
            vu:Button2Down(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
            wait(1)
            vu:Button2Up(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
        end)
        safeNotify("AFK", "Anti-AFK enabled", 3)
    end
})

local PlayerSection = Tabs.Player:AddSection("Player Interactions")

local playersList = {}
local function buildPlayerList()
    playersList = {}
    for _, p in pairs(Players:GetPlayers()) do
        table.insert(playersList, p.Name)
    end
end
buildPlayerList()
local SelectedPlayer = nil
local dropdownRef = nil

dropdownRef = PlayerSection:AddDropdown("SelectPlayer", {
    Title = "Select Player",
    Description = "Choose a player",
    Values = playersList,
    Multi = false,
    Default = 1,
    Callback = function(value)
        SelectedPlayer = Players:FindFirstChild(value)
    end
})

PlayerSection:AddButton({
    Title = "Refresh Players",
    Description = "Update player dropdown",
    Callback = function()
        buildPlayerList()
        pcall(function()
            dropdownRef:SetValues(playersList)
        end)
        safeNotify("Players", "Player list refreshed (" .. tostring(#playersList) .. ")", 3)
    end
})

Players.PlayerAdded:Connect(function(p)
    table.insert(playersList, p.Name)
    pcall(function() dropdownRef:SetValues(playersList) end)
end)

Players.PlayerRemoving:Connect(function(p)
    for i, name in ipairs(playersList) do
        if name == p.Name then table.remove(playersList, i); break end
    end
    pcall(function() dropdownRef:SetValues(playersList) end)
end)

local Following = false
local followCoroutine = nil

PlayerSection:AddToggle("FollowPlayer", {
    Title = "Follow Player",
    Description = "Follow selected player",
    Default = false,
    Callback = function(state)
        Following = state
        if Following then
            if followCoroutine and coroutine.status(followCoroutine) ~= "dead" then return end
            followCoroutine = coroutine.create(function()
                while Following and SelectedPlayer and SelectedPlayer.Character and LocalPlayer.Character do
                    local targetHRP = SelectedPlayer.Character:FindFirstChild("HumanoidRootPart")
                    local myHRP = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                    if targetHRP and myHRP then
                        myHRP.CFrame = targetHRP.CFrame * CFrame.new(0, 0, 5)
                    end
                    wait(0.12)
                end
            end)
            coroutine.resume(followCoroutine)
        end
    end
})

PlayerSection:AddButton({
    Title = "Unfollow",
    Description = "Stop following",
    Callback = function()
        Following = false
    end
})

PlayerSection:AddButton({
    Title = "Scare Player",
    Description = "scare em",
    Callback = function()
        if SelectedPlayer and SelectedPlayer.Character and LocalPlayer.Character then
            local myHRP = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            local targetHRP = SelectedPlayer.Character:FindFirstChild("HumanoidRootPart")
            if myHRP and targetHRP then
                local originalCFrame = myHRP.CFrame
                local forwardOffset = targetHRP.CFrame.LookVector * 3
                myHRP.CFrame = targetHRP.CFrame + forwardOffset
                task.delay(0.5, function() 
                    if myHRP and myHRP.Parent then
                        myHRP.CFrame = originalCFrame
                    end
                end)
                safeNotify("Scare", "Scaring " .. SelectedPlayer.Name, 4)
            end
        else
            safeNotify("Scare", "No player selected", 3)
        end
    end
})

PlayerSection:AddButton({
    Title = "TP to Player",
    Description = "Teleport to selected player",
    Callback = function()
        if SelectedPlayer and SelectedPlayer.Character and LocalPlayer.Character then
            local s = SelectedPlayer.Character:FindFirstChild("HumanoidRootPart")
            local m = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if s and m then m.CFrame = s.CFrame end
        end
    end
})

PlayerSection:AddButton({
    Title = "Kill Player",
    Description = "Simulate killing (break joints)",
    Callback = function()
        if SelectedPlayer and SelectedPlayer.Character then
            pcall(function() SelectedPlayer.Character:BreakJoints() end)
        end
    end
})

PlayerSection:AddButton({
    Title = "Whisper",
    Description = "Send whisper message uses TextChatService if available",
    Callback = function()
        if SelectedPlayer then
            pcall(function()
                local tcs = game:GetService("TextChatService")
                if tcs and tcs.TextChannels and tcs.TextChannels.RBXGeneral then
                    tcs.TextChannels.RBXGeneral:SendAsync("/w " .. SelectedPlayer.Name .. " Hello!")
                else
                    safeNotify("Whisper", "TextChatService not available", 3)
                end
            end)
        end
    end
})

PlayerSection:AddButton({
    Title = "Spectate",
    Description = "Spectate selected player",
    Callback = function()
        if SelectedPlayer and SelectedPlayer.Character then
            local hum = SelectedPlayer.Character:FindFirstChildOfClass("Humanoid")
            if hum then workspace.CurrentCamera.CameraSubject = hum end
        end
    end
})

local triSpin = false
local triConnection

PlayerSection:AddToggle("TriangleSpin", {
    Title = "helicopter Spin",
    Description = "Spin in a helicopter pattern use with Fly",
    Default = false,
    Callback = function(state)
        triSpin = state

        if triSpin then
            local hrp = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if not hrp then return end

            local points = {
                Vector3.new(10, 0, 0),
                Vector3.new(-10, 0, 10),
                Vector3.new(-10, 0, -10)
            }

            local index = 1

            triConnection = RunService.Heartbeat:Connect(function()
                if not triSpin then return end
                local target = hrp.Position + points[index]
                hrp.CFrame = CFrame.new(hrp.Position, target) + (CFrame.new() * (hrp.CFrame.LookVector * 3))
                index = index + 1
                if index > #points then index = 1 end
            end)
        else
            if triConnection then
                triConnection:Disconnect()
                triConnection = nil
            end
        end
    end
})

PlayerSection:AddButton({
    Title = "Stop Spectate",
    Description = "Reset camera",
    Callback = function()
        if LocalPlayer.Character then
            local hum = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if hum then workspace.CurrentCamera.CameraSubject = hum end
        end
    end
})

PlayerSection:AddButton({
    Title = "Friend Request",
    Description = "Send friend request",
    Callback = function()
        if SelectedPlayer then
            local success, result = pcall(function()
                LocalPlayer:RequestFriendship(SelectedPlayer)
            end)

            if success then
                safeNotify("Friend Request", "Sent a friend request to " .. SelectedPlayer.Name, 4)
            else
                safeNotify("Friend Request", "Failed to send friend request", 4)
            end
        else
            safeNotify("Friend Request", "No player selected", 3)
        end
    end
})

local checkpoint = nil
local checkpointName = nil
local CheckpointSection = Tabs.Player:AddSection("Checkpoint")

CheckpointSection:AddButton({
    Title = "Set Checkpoint (Current Position)",
    Description = "Stores your current HumanoidRootPart CFrame as checkpoint",
    Callback = function()
        if LocalPlayer.Character then
            local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if hrp then
                checkpoint = hrp.CFrame
                checkpointName = "Custom"
                safeNotify("Checkpoint", "Checkpoint set at your current position", 3)
            else
                safeNotify("Checkpoint", "HumanoidRootPart not found", 3)
            end
        end
    end
})

CheckpointSection:AddButton({
    Title = "Set Checkpoint to Spawn",
    Description = "Set checkpoint to workspace SpawnLocation if present",
    Callback = function()
        if workspace:FindFirstChild("SpawnLocation") then
            checkpoint = workspace.SpawnLocation.CFrame
            checkpointName = "Spawn"
            safeNotify("Checkpoint", "Checkpoint set to Spawn", 3)
        else
            safeNotify("Checkpoint", "No SpawnLocation found", 3)
        end
    end
})

CheckpointSection:AddButton({
    Title = "TP to Checkpoint",
    Description = "Teleport to your stored checkpoint",
    Callback = function()
        if checkpoint and LocalPlayer.Character then
            local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if hrp then
                hrp.CFrame = checkpoint
                safeNotify("Checkpoint", "Teleported to checkpoint (" .. tostring(checkpointName or "Custom") .. ")", 3)
            end
        else
            safeNotify("Checkpoint", "No checkpoint set", 3)
        end
    end
})

local MiscSection = Tabs.Misc:AddSection("Miscellaneous Features")

MiscSection:AddButton({
    Title = "Invisible",
    Description = "Make character invisible",
    Callback = function()
        if LocalPlayer.Character then
            for _, part in pairs(LocalPlayer.Character:GetChildren()) do
                if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                    part.Transparency = 1
                end
            end
        end
    end
})

MiscSection:AddButton({
    Title = "Visible",
    Description = "Make character visible",
    Callback = function()
        if LocalPlayer.Character then
            for _, part in pairs(LocalPlayer.Character:GetChildren()) do
                if part:IsA("BasePart") then
                    part.Transparency = 0
                end
            end
        end
    end
})

MiscSection:AddToggle("DayTime", {
    Title = "Day Time",
    Description = "Set to day",
    Default = false,
    Callback = function(state)
        if state then
            if game:GetService("Lighting") then game:GetService("Lighting").TimeOfDay = "12:00:00" end
        else
            if game:GetService("Lighting") then game:GetService("Lighting").TimeOfDay = "00:00:00" end
        end
    end
})

MiscSection:AddButton({
    Title = "Full Bright",
    Description = "Max brightness",
    Callback = function()
        local lighting = game:GetService("Lighting")
        lighting.Brightness = 2
        lighting.GlobalShadows = false
        lighting.FogEnd = 999999
    end
})

MiscSection:AddButton({
    Title = "Spawn tptool",
    Description = "Spawn a Tptool",
    Callback = function()
        local backpack = LocalPlayer:FindFirstChild("Backpack")
        if not backpack then return end

        local tpTool = Instance.new("Tool")
        tpTool.Name = "TP Tool"
        tpTool.RequiresHandle = false
        tpTool.CanBeDropped = true

        tpTool.Activated:Connect(function()
            local mouse = LocalPlayer:GetMouse()
            local hrp = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
            if hrp and mouse then
                hrp.CFrame = CFrame.new(mouse.Hit.Position + Vector3.new(0,3,0))
            end
        end)

        tpTool.Parent = backpack
        safeNotify("Spawn Item", "TP Tool spawned in your backpack!", 4)
    end
})

MiscSection:AddButton({
    Title = "Remove Fog",
    Description = "Clear fog",
    Callback = function()
        game:GetService("Lighting").FogEnd = 999999
    end
})

local Spam = false
local spamThread = nil

MiscSection:AddToggle("ChatSpam", {
    Title = "Chat Spam",
    Description = "Spam chat",
    Default = false,
    Callback = function(state)
        Spam = state
        if Spam then
            spamThread = coroutine.create(function()
                while Spam do
                    pcall(function()
                        local tcs = game:GetService("TextChatService")
                        if tcs and tcs.TextChannels and tcs.TextChannels.RBXGeneral then
                            tcs.TextChannels.RBXGeneral:SendAsync("YUKKY WUKKY")
                        end
                    end)
                    wait(1)
                end
            end)
            coroutine.resume(spamThread)
        end
    end
})

local AutoClick = false
local autoclickThread = nil

MiscSection:AddToggle("AutoClick", {
    Title = "Auto Click",
    Description = "Auto mouse click",
    Default = false,
    Callback = function(state)
        AutoClick = state
        if state then
            autoclickThread = coroutine.create(function()
                while AutoClick do
                    if mouse1click then
                        pcall(mouse1click)
                    end
                    task.wait(0.05)
                end
            end)
            coroutine.resume(autoclickThread)
        end
    end
})

MiscSection:AddButton({
    Title = "Loop Kill All",
    Description = "Kill all players loop",
    Callback = function()
        safeRunAsync(function()
            while true do
                for _, player in pairs(Players:GetPlayers()) do
                    if player ~= LocalPlayer and player.Character then
                        pcall(function() player.Character:BreakJoints() end)
                    end
                end
                wait(1)
            end
        end)
    end
})

MiscSection:AddSlider("Gravity", {
    Title = "Gravity",
    Description = "Adjust gravity",
    Default = 196,
    Min = 0,
    Max = 500,
    Rounding = 1,
    Callback = function(value)
        workspace.Gravity = value
    end
})

local SettingsSection = Tabs.Settings:AddSection("Game Settings")

SettingsSection:AddToggle("AutoLoadScript", {
    Title = "Auto Load Script",
    Description = "Automatically loads the script on rejoin",
    Default = true,
    Callback = function(state)
        if state then
            getgenv().AP_AutoLoad = game.PlaceId
            local qot = queue_on_teleport or syn and syn.queue_on_teleport or fluxus and fluxus.queue_on_teleport
            if qot then
                pcall(function()
                    qot('loadstring(game:HttpGet("https://raw.githubusercontent.com/magbux/ryurakio/main/ryusai"))()')
                end)
            end
            safeNotify("Auto Load", "Auto load enabled for this game", 5)
        else
            getgenv().AP_AutoLoad = nil
            safeNotify("Auto Load", "Auto load disabled", 5)
        end
    end
})

SettingsSection:AddButton({
    Title = "Copy Auto Load The Script",
    Description = "Copy the loadstring to clipboard",
    Callback = function()
        if setclipboard then
            setclipboard('loadstring(game:HttpGet("https://raw.githubusercontent.com/magbux/ryurakio/main/ryusai"))()')
            safeNotify("Copied", "Auto load command copied to clipboard!", 5)
        else
            safeNotify("Copied", "setclipboard not available in this executor", 5)
        end
    end
})

SettingsSection:AddSlider("FOV", {
    Title = "Field of View",
    Description = "Adjust FOV",
    Default = 70,
    Min = 70,
    Max = 120,
    Rounding = 1,
    Callback = function(value)
        if workspace.CurrentCamera then
            workspace.CurrentCamera.FieldOfView = value
        end
    end
})

SettingsSection:AddButton({
    Title = "Unlock FPS",
    Description = "Remove FPS cap (if supported)",
    Callback = function()
        pcall(function() if setfpscap then setfpscap(999) end end)
        safeNotify("FPS", "Attempted to set FPS cap to 999", 3)
    end
})

SettingsSection:AddKeybind("ToggleGUI", {
    Title = "Toggle GUI",
    Description = "Bind to toggle hub",
    Default = "RightShift",
    Callback = function(key)
        Window:Minimize()
    end
})

SettingsSection:AddButton({
    Title = "Destroy GUI",
    Description = "Close the hub",
    Callback = function()
        if Window and Window.Destroy then Window:Destroy() end
    end
})

SettingsSection:AddButton({
    Title = "Rejoin",
    Description = "Rejoin the server",
    Callback = function()
        safeRunAsync(function()
            pcall(function() TeleportService:Teleport(game.PlaceId, LocalPlayer) end)
        end)
    end
})

SettingsSection:AddButton({
    Title = "Server Hop",
    Description = "Attempting to server hop",
    Callback = function()
        safeRunAsync(function()
            safeNotify("Server Hop", "Attempting to server hop", 5)
            pcall(function() TeleportService:Teleport(game.PlaceId, LocalPlayer) end)
        end)
    end
})

SettingsSection:AddButton({
    Title = "Auto Save",
    Description = "Save setting",
    Callback = function()
        pcall(function() SaveManager:Save() end)
        safeNotify("Saving", "click afew more times", 3)
    end
})

local ShowHitboxesEnabled = false
local hitboxConns = {}

local function createHitboxForPart(part)
    if not part then return end
    if part:FindFirstChild("HitboxBox") then return end
    local box = Instance.new("SelectionBox")
    box.Name = "HitboxBox"
    box.Adornee = part
    box.LineThickness = 0.02
    box.SurfaceTransparency = 0.5
    box.Parent = part
end

local function removeHitboxesFromCharacter(char)
    if not char then return end
    for _, d in pairs(char:GetDescendants()) do
        if d.Name == "HitboxBox" and d:IsA("SelectionBox") then
            pcall(function() d:Destroy() end)
        end
    end
end

SettingsSection:AddToggle("ShowHitboxes", {
    Title = "Show Hitboxes",
    Description = "Toggle hitboxes of all players",
    Default = false,
    Callback = function(state)
        ShowHitboxesEnabled = state
        if ShowHitboxesEnabled then
            for _, player in pairs(Players:GetPlayers()) do
                if player.Character then
                    for _, part in pairs(player.Character:GetDescendants()) do
                        if part:IsA("BasePart") and (part.Name == "HumanoidRootPart" or part.Name == "Head" or part.Name:match("Torso") or part.Name:match("Upper")) then
                            createHitboxForPart(part)
                        end
                    end
                end
                if not hitboxConns[player] then
                    hitboxConns[player] = {}
                    hitboxConns[player].charAdded = player.CharacterAdded:Connect(function(char)
                        task.wait(0.1)
                        for _, part in pairs(char:GetDescendants()) do
                            if part:IsA("BasePart") and (part.Name == "HumanoidRootPart" or part.Name == "Head" or part.Name:match("Torso") or part.Name:match("Upper")) then
                                createHitboxForPart(part)
                            end
                        end
                    end)
                end
            end
            if not hitboxConns.PlayerAdded then
                hitboxConns.PlayerAdded = Players.PlayerAdded:Connect(function(plr)
                    hitboxConns[plr] = {}
                    hitboxConns[plr].charAdded = plr.CharacterAdded:Connect(function(char)
                        task.wait(0.1)
                        for _, part in pairs(char:GetDescendants()) do
                            if part:IsA("BasePart") and (part.Name == "HumanoidRootPart" or part.Name == "Head" or part.Name:match("Torso") or part.Name:match("Upper")) then
                                createHitboxForPart(part)
                            end
                        end
                    end)
                end)
            end
        else
            for _, player in pairs(Players:GetPlayers()) do
                if player.Character then
                    removeHitboxesFromCharacter(player.Character)
                end
                if hitboxConns[player] then
                    if hitboxConns[player].charAdded and hitboxConns[player].charAdded.Connected then
                        hitboxConns[player].charAdded:Disconnect()
                    end
                    hitboxConns[player] = nil
                end
            end
            if hitboxConns.PlayerAdded and hitboxConns.PlayerAdded.Connected then
                hitboxConns.PlayerAdded:Disconnect()
                hitboxConns.PlayerAdded = nil
            end
        end
    end
})

SettingsSection:AddDropdown("Theme", {
    Title = "Theme",
    Description = "Change UI theme",
    Values = {"Dark", "Light", "Mocha", "Aqua", "Rose"},
    Multi = false,
    Default = Fluent.Options.Theme or "Dark",
    Callback = function(value)
        Fluent.Options.Theme = value
    end
})

SettingsSection:AddButton({
    Title = "Test Notification",
    Description = "Send test notify",
    Callback = function()
        safeNotify("YO", "easter eggðŸ¥š", 3)
    end
})

SettingsSection:AddSlider("Volume", {
    Title = "Volume",
    Description = "Adjust sound volume",
    Default = 50,
    Min = 0,
    Max = 100,
    Rounding = 1,
    Callback = function(value)
        safeNotify("Volume", "Volume set to " .. tostring(value), 2)
    end
})

local ExtrasSection = Tabs.Extras:AddSection("Extra Features")

ExtrasSection:AddButton({
    Title = "Load Aimbot",
    Description = "Load aimbot script",
    Callback = function()
        safeRunAsync(function()
            pcall(function() loadstring(game:HttpGet("https://pastebin.com/raw/RZK9XdtH"))() end)
        end)
    end
})

ExtrasSection:AddButton({
    Title = "Wallhack",
    Description = "See through walls",
    Callback = function()
        for _, part in pairs(workspace:GetDescendants()) do
            if part:IsA("BasePart") then
                pcall(function() part.Transparency = 0.5 end)
            end
        end
    end
})

ExtrasSection:AddButton({
    Title = "Remove Wallhack",
    Description = "Reset transparency",
    Callback = function()
        for _, part in pairs(workspace:GetDescendants()) do
            if part:IsA("BasePart") then
                pcall(function() part.Transparency = 0 end)
            end
        end
    end
})

ExtrasSection:AddButton({
    Title = "Btools",
    Description = "Gives btools",
    Callback = function()
        local backpack = LocalPlayer:FindFirstChild("Backpack")
        if backpack then
            for _, t in pairs({"Hammer","Clone","Grab"}) do
                local hb = Instance.new("HopperBin")
                hb.Parent = backpack
                if t == "Hammer" then hb.BinType = Enum.BinType.Hammer end
                if t == "Clone" then hb.BinType = Enum.BinType.Clone end
                if t == "Grab" then hb.BinType = Enum.BinType.Grab end
            end
        end
    end
})

ExtrasSection:AddButton({
    Title = "Load Dex",
    Description = "Load dark dex explorer",
    Callback = function()
        safeRunAsync(function()
            pcall(function() loadstring(game:HttpGet("https://raw.githubusercontent.com/Babyhamsta/RBX_DarkDex/main/source.lua"))() end)
        end)
    end
})

ExtrasSection:AddButton({
    Title = "Remote Spy",
    Description = "Load remote spy",
    Callback = function()
        safeRunAsync(function()
            pcall(function() loadstring(game:HttpGet("https://raw.githubusercontent.com/CloneTrooper1019/Roblox-Client-Tracker/master/Client/Libraries/RemoteSpyHook.lua"))() end)
        end)
    end
})

ExtrasSection:AddButton({
    Title = "Dump Scripts",
    Description = "Dump game scripts (placeholder)",
    Callback = function()
        safeNotify("Dump", "Dumping scripts placeholder...", 4)
    end
})

ExtrasSection:AddSlider("VehicleSpeed", {
    Title = "Vehicle Speed",
    Description = "Boost vehicle",
    Default = 100,
    Min = 100,
    Max = 500,
    Rounding = 1,
    Callback = function(value)
        safeNotify("Vehicle", "Vehicle speed set to " .. tostring(value), 3)
    end
})

SaveManager:SetLibrary(Fluent)
InterfaceManager:SetLibrary(Fluent)
SaveManager:IgnoreThemeSettings()
SaveManager:SetIgnoreIndexes({})
InterfaceManager:SetFolder("FluentScriptHub")
SaveManager:SetFolder("FluentScriptHub/specific-game")
InterfaceManager:BuildInterfaceSection(Tabs.Settings)
SaveManager:BuildConfigSection(Tabs.Settings)
Window:SelectTab(1)
SaveManager:LoadAutoloadConfig()

if getgenv().AP_AutoLoad == game.PlaceId then
    local ok, err = pcall(function()
        local toggle = SettingsSection:GetToggle("AutoLoadScript")
        if toggle and toggle.SetValue then
            toggle:SetValue(true)
        end
    end)
end

safeNotify("Hub Ready", "uhh", 6)
